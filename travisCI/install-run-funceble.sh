#!/bin/bash
# Fetch funceble script files and run a test
# Created by: Mitchell Krog (mitchellkrog@gmail.com)
# Copyright: Mitchell Krog - https://github.com/mitchellkrogza
# Repo Url: https://github.com/mitchellkrogza/The-Big-List-of-Hacked-Malware-Web-Sites
# Find funceble at: https://github.com/funilrys/funceble
# ******************************************************

# Set our Input File
# *******************
_input=$TRAVIS_BUILD_DIR/travisCI/_strip_domains/domains.txt

# Get latest versions of funceble from repo
# *****************************************
sudo wget https://raw.githubusercontent.com/funilrys/funceble/master/funceble -O $TRAVIS_BUILD_DIR/travisCI/_funceble/funceble
sudo wget https://raw.githubusercontent.com/funilrys/funceble/master/tool -O $TRAVIS_BUILD_DIR/travisCI/_funceble/tool
sudo wget https://raw.githubusercontent.com/funilrys/funceble/master/iana-domains-db -O $TRAVIS_BUILD_DIR/travisCI/_funceble/iana-domains-db

# Install Funceble Dependencies
# *****************************
sudo apt-get -y install expect
sudo apt-get -y install whois

# Make scripts executable by Travis
# *********************************
sudo chmod +x $TRAVIS_BUILD_DIR/travisCI/_funceble/tool
sudo chmod +x $TRAVIS_BUILD_DIR/travisCI/_funceble/funceble

cd $TRAVIS_BUILD_DIR/travisCI/_funceble/

# Run Funceble Install Tool
# *************************
sudo bash $TRAVIS_BUILD_DIR/travisCI/_funceble/tool -i

#  Run Funceble and Check Domains List
# ************************************
sudo bash $TRAVIS_BUILD_DIR/travisCI/_funceble/funceble -a -t 5 -h -f $_input

exit 0
